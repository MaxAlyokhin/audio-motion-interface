### Audio Motion Interface (AMI)

Алгоритм синтезирует звук на основе данных с датчиков движения смартфона. Предусмотрен т.н. локальный режим (когда смартфон просто проводом подключается к колонкам или наушникам) и удалённый режим (когда смартфон и колонки разнесены в пространстве, а данные идут по протоколу <a href="https://ru.wikipedia.org/wiki/WebSocket">websocket</a> через промежуточный сервер).

Обратите внимание, что алгоритм отдаёт лишь "чистый" звук, оставляя на ваше усмотрение возможность его обработки (это могут быть как "примочки", так и разнообразные DAW вроде Ableton, Cubase, FL Studio и т.д.).

### Стратегия синтеза

##### Локальный режим:

<i>Источник данных</i> и <i>управление данными</i> находятся на смартфоне (совмещены).

- смартфон → миниджек → колонки
- смартфон → миниджек → аблетон → миниджек → колонки

##### Удалённый режим:

<i>Источник данных</i> находится на смартфоне, а <i>управление данными</i> находится на удалённой машине (разнесены).

- смартфон → вебсокет → браузер → миниджек → колонки
- смартфон → вебсокет → браузер → аблетон → миниджек → колонки

<b>Плюсы:</b>

- смартфон не связан проводом с ноутбуком;
- разделение источника данных от управления данными - ноутбук лучше справится с обработкой данных;

<b>Минусы:</b>

- исполнителю не слышно ничего (можно одновременно генерить звук локально со смартфона в наушники и дополнительно дублировать данные движения на удалённую машину; по идее, тогда любой может подключиться к прослушиванию исполнения и можно сделать распределённое удалённое прослушивание откуда угодно; но тогда удалённые слушателя останутся без обработки ableton, только обработка с сервера);
- есть задержка до 100мс;

##### Совмещённый режим:

Можно сделать так: у нас должен быть локальный источник данных, удалённый источник данных и ноутбук (т.е. два смартфона и ноутбук). На ноуте открыта вкладка с удалённым источником данных + настройки ноута и смартфон с локальными настройками по проводу в ноут. Аблетон принимает два источника: по миниджеку и с браузера.

### Общая архитектура

`motion.js` занимается датчиками - акселерометром и гироскопом.
Он вешает слушатели событий движения и вызывает `audio.js` по каждому событию

`audio.js` принимает данные о движении и генерирует звук

### Настройка

npm i

Генерация ssl-сертификата

https://stackoverflow.com/questions/21397809/create-a-trusted-self-signed-ssl-cert-for-localhost-for-use-with-express-node

cd client

npm i

### Запуск

В первом терминале:
nodemon index

Во втором терминале:
cd client

gulp

На компе и смартфоне открываем https://192.168.0.103:3000/

Включаем удалённую стратегию синтеза

Для вертолёта: туннелируем ngrok http https://localhost:3000
На компе открываем localhost:3000
На смартфоне сгенеренную ngrok ссылку на туннель

#### Название?

audio
motion
orientation
sonification
interface
algorithm
sonic

ormoson
ormosonic
orientation-motion-sonification

motion synth

audio motion interface

Sonification Interface for motion and orientation

#### Как сонифицировать:

- Только акселерометр:
  параметры звука это константы, акселерометр определяет частоту;

- Комбинация датчиков:
  акселерометр определяет громкость;
  гироскоп частоту;

  При таком раскладе нам не надо делать oscillator.stop() т.к. громкость у нас сама падает при отсутствии движения. Тогда всё можно делать на одном осцилляторе.

#### Bags and features

DEV:

- TODO: создать нормальную документацию по разработке
- TODO: создать юзер гайд по инструменту с видео, гайд по развёртке с ноутом (по сути надо будет поставить ноду и запустить index.js с серверами, gulp и исходники фронта не нужны. Только нужно преодолеть https-сертификаты)
- TODO: режим записи нот (для трюка с импровизацией/композицией для падающего смартфона). по каждому событию движения частота переводится в ноту и затем проверяется режим записи из сеттингс - если вкл, то иннертекстим ноту на экран. далее можно допилить рисовку на нотном стане и даже отдельный фронтэнд для только партитуры

FIX:

- TODO: BAG-2 в плюрале чтобы лишние ноты не создавались (дребезг контакта) когда скорость близка к отсечке
- TODO: BAG-3 в firefox не работает ws