### Audio Motion Interface (AMI)

Алгоритм синтезирует звук на основе данных с датчиков движения смартфона. Предусмотрен т.н. локальный режим (когда смартфон просто проводом подключается к колонкам или наушникам) и удалённый режим (когда смартфон и колонки разнесены в пространстве, а данные идут по протоколу <a href="https://ru.wikipedia.org/wiki/WebSocket">websocket</a> через промежуточный сервер).

Обратите внимание, что алгоритм отдаёт лишь "чистый" звук, оставляя на ваше усмотрение возможность его обработки (это могут быть как "примочки", так и разнообразные DAW вроде Ableton, Cubase, FL Studio и т.д.).

### Стратегия синтеза

##### Локальный режим:

<i>Источник данных</i> и <i>управление данными</i> находятся на смартфоне (совмещены).

- смартфон → миниджек → колонки
- смартфон → миниджек → аблетон → миниджек → колонки

##### Удалённый режим:

<i>Источник данных</i> находится на смартфоне, а <i>управление данными</i> находится на удалённой машине (разнесены).

- смартфон → вебсокет → браузер → миниджек → колонки
- смартфон → вебсокет → браузер → аблетон → миниджек → колонки

<b>Плюсы:</b>

- смартфон не связан проводом с ноутбуком;
- разделение источника данных от управления данными - ноутбук лучше справится с обработкой данных;

<b>Минусы:</b>

- исполнителю не слышно ничего (можно одновременно генерить звук локально со смартфона в наушники и дополнительно дублировать данные движения на удалённую машину; по идее, тогда любой может подключиться к прослушиванию исполнения и можно сделать распределённое удалённое прослушивание откуда угодно; но тогда удалённые слушателя останутся без обработки ableton, только обработка с сервера);
- есть задержка до 100мс;

##### Совмещённый режим:

Можно сделать так: у нас должен быть локальный источник данных, удалённый источник данных и ноутбук (т.е. два смартфона и ноутбук). На ноуте открыта вкладка с удалённым источником данных + настройки ноута и смартфон с локальными настройками по проводу в ноут. Аблетон принимает два источника: по миниджеку и с браузера.

### Общая архитектура

`motion.js` занимается датчиками - акселерометром и гироскопом.
Он вешает слушатели событий движения и вызывает `audio.js` по каждому событию

`audio.js` принимает данные о движении и генерирует звук

### Настройка

npm i

Генерация ssl-сертификата

https://stackoverflow.com/questions/21397809/create-a-trusted-self-signed-ssl-cert-for-localhost-for-use-with-express-node

cd client

npm i

### Запуск

В первом терминале:
nodemon index

Во втором терминале:
cd client

gulp

На компе и смартфоне открываем https://192.168.0.103:3000/

Включаем удалённую стратегию синтеза

#### Название?

audio
motion
orientation
sonification
interface
algorithm
sonic

ormoson
ormosonic
orientation-motion-sonification

audio motion interface

Sonification Interface for motion and orientation

#### Как сонифицировать:

- Только акселерометр:
  параметры звука это константы, акселерометр определяет частоту;

- Комбинация датчиков:
  акселерометр определяет громкость;
  гироскоп частоту;

  При таком раскладе нам не надо делать oscillator.stop() т.к. громкость у нас сама падает при отсутствии движения. Тогда всё можно делать на одном осцилляторе.

#### Bags and features

High:

TODO: тюнер как опция
TODO: поправить вёрстку, разбить на разделы
TODO: определиться как отличаются интерфейсы моб и деск при распределённом режиме
TODO: баг при переходе между стратегиями синтеза - последний звук остаётся играть
TODO: в плюрале чтобы лишние ноты не создавались (дребезг контакта) когда скорость близка к отсечке
TODO: троттлинг-лимит (события генерятся со скоростью 16 мс; можно сделать больше для облегчения вычислений); этот параметр должен коррелировать с exponentialRampToValueAtTime, т.е. затуханием звука, чтобы всё сливалось в непрерывный звук;
TODO: сделать контроль перехода на противоположную полусферу
TODO: режим отключённого интерфейса (переключение происходит по жесту либо нажатию двух удалённых точек на экране)

Low:

TODO: режим левши/правши (если поменять местами от/до не неполучится искомое?)
TODO: включение/отключение синтеза (active, disactive) по повторному нажатию на Run;
TODO: добавить отображение статуса ws на стороне смартфона ("точек синтеза не обнаружено");
TODO: proxy-режим: локально ноут + смартфон чтобы себя слышать без задержки, далее эта инфа ретранслируется на удалённый сервер, где раздаётся слушателям;
TODO: юзать ли отрицательные числа;
TODO: все осцилляторы должны подключаться к одному внешнему gainNode;
TODO: в firefox не работает ws
